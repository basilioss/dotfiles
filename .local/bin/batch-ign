#!/usr/bin/env bash
#
# Description: Apply all the available palettes from ImageGoNerd to the image
# Name: batch-ign
# Usage: batch-ign <path/to/image.png>
# Homepage: https://github.com/basilioss/dotfiles
# https://github.com/Schrodinger-Hat/ImageGoNord

# Path to source code of ImageGoNerd
image_go_nerd="$HOME/.local/src/image-go-nord/"
# Remove leading directory portions from a path to the image
file="$(basename "$1")"
# Remove image extension
filename="${file%%.*}"
colorpalettes=($(ls "$image_go_nerd"/src/palettes))
count=0

mkdir "$HOME/wal-$filename"
cd "$HOME/wal-$filename" || exit

# Color schames to lowercase
for colorpalette in "${colorpalettes[@]}"; do
    colorpalettes[$count]="$(printf "$colorpalette" | tr [:upper:] [:lower:])"
    count=$((count + 1))
done

for colorpalette in "${colorpalettes[@]}"; do
    python "$image_go_nerd"/src/cli.py --"$colorpalette" -i="$1" -o="$filename-$colorpalette"
done
